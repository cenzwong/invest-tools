<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Range Trading Hub | Computational Suite</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- KaTeX for LaTeX rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" onload="try { renderMathInElement(document.body); } catch(e) { console.error(e); }"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Noto+Sans+TC:wght@300;400;700&display=swap');
        
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #0f172a;
            color: #f1f5f9;
        }

        .glass-card {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .input-dark {
            background: #334155;
            border: 1px solid #475569;
            color: #f1f5f9;
        }

        .input-dark:focus {
            outline: none;
            border-color: #38bdf8;
            box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.2);
        }

        .tab-active {
            border-bottom: 2px solid #38bdf8;
            color: #38bdf8 !important;
        }

        .info-box {
            background: rgba(15, 23, 42, 0.95);
            border-left: 4px solid #38bdf8;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
        }

        .tooltip-text {
            visibility: hidden;
            width: 220px;
            background-color: #1e293b;
            color: #fff;
            text-align: left;
            border-radius: 8px;
            padding: 10px;
            position: absolute;
            z-index: 100;
            bottom: 125%;
            left: 50%;
            margin-left: -110px;
            opacity: 0;
            transition: opacity 0.2s;
            font-size: 0.75rem;
            line-height: 1.4;
            border: 1px solid #38bdf8;
            pointer-events: none;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .group:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .katex { font-size: 1.05em; }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
    </style>
</head>
<body class="min-h-screen pb-12">

    <!-- Header -->
    <header class="relative py-8 px-6 text-center border-b border-slate-800 bg-slate-900/50">
        <div class="absolute top-4 right-6 flex items-center space-x-2 bg-slate-800 p-1 rounded-lg border border-slate-700">
            <button onclick="setLanguage('en')" id="btn-en" class="px-3 py-1 text-xs font-bold rounded transition-all bg-sky-500 text-white">EN</button>
            <button onclick="setLanguage('zh')" id="btn-zh" class="px-3 py-1 text-xs font-bold rounded transition-all text-slate-400 hover:text-white">ÁπÅ</button>
        </div>

        <h1 data-i18n="header-title" class="text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-sky-400 to-indigo-500">
            Range Trading Hub
        </h1>
        <p data-i18n="header-subtitle" class="mt-2 text-slate-400 text-sm md:text-base">Professional Computational Textbook</p>
    </header>

    <main class="max-w-6xl mx-auto px-4 mt-8">
        
        <!-- Tabs -->
        <div class="flex justify-center mb-8 space-x-4 md:space-x-8 text-sm font-semibold uppercase tracking-wider border-b border-slate-800">
            <button onclick="switchTab('calculators')" id="tab-calculators" data-i18n="tab-calc" class="pb-4 tab-active transition-all">Calculators</button>
            <button onclick="switchTab('knowledge')" id="tab-knowledge" data-i18n="tab-know" class="pb-4 text-slate-500 hover:text-slate-300 transition-all">Knowledge Base</button>
            <button onclick="switchTab('strategies')" id="tab-strategies" data-i18n="tab-strat" class="pb-4 text-slate-500 hover:text-slate-300 transition-all">Strategies</button>
        </div>

        <!-- CALCULATORS SECTION -->
        <section id="sect-calculators" class="space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                
                <!-- Pivot Point Calculator -->
                <div class="glass-card p-6 rounded-2xl shadow-xl flex flex-col">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="p-2 bg-sky-500/20 rounded-lg">
                                <svg class="w-6 h-6 text-sky-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                            </div>
                            <h2 data-i18n="calc-pivot-title" class="text-xl font-bold">Pivot Points (Floor)</h2>
                        </div>
                        <button onclick="toggleInfo('pivot')" class="text-slate-500 hover:text-sky-400 transition-colors">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg>
                        </button>
                    </div>

                    <div id="info-pivot" class="hidden info-box p-5 mb-6 text-sm">
                        <h4 class="font-bold text-sky-400 mb-2" data-i18n="textbook-pivot-h">Textbook: What are Pivot Points?</h4>
                        <p class="text-slate-300 mb-4" data-i18n="textbook-pivot-p">Pivots are mathematical "gravity centers" based on the previous session's range.</p>
                        <div class="bg-slate-900 rounded-lg p-4 mb-4 overflow-x-auto space-y-4">
                            <div class="text-center">$$PP = \frac{High + Low + Close}{3}$$</div>
                            <div class="grid grid-cols-2 gap-x-4 gap-y-2 text-xs">
                                <div>$$R1 = (2 \times PP) - Low$$</div>
                                <div>$$S1 = (2 \times PP) - High$$</div>
                                <div>$$R2 = PP + (H - L)$$</div>
                                <div>$$S2 = PP - (H - L)$$</div>
                            </div>
                        </div>
                        <p class="text-xs text-slate-400" data-i18n="textbook-pivot-logic">Logic: $PP$ is the fair value. $R1/S1$ identify immediate boundaries, $R2/S2$ are extreme deviation points.</p>
                    </div>
                    
                    <div class="space-y-4 flex-grow">
                        <div class="grid grid-cols-3 gap-4">
                            <div class="relative group">
                                <label class="text-xs text-slate-400 flex items-center mb-1">
                                    <span data-i18n="label-high">High</span>
                                    <svg class="w-3 h-3 ml-1 text-slate-500 cursor-help" fill="currentColor" viewBox="0 0 20 20"><path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg>
                                    <span class="tooltip-text" data-i18n="tip-high">Highest price of the previous session.</span>
                                </label>
                                <input type="number" id="pHigh" class="w-full p-2 rounded input-dark">
                            </div>
                            <div class="relative group">
                                <label class="text-xs text-slate-400 flex items-center mb-1">
                                    <span data-i18n="label-low">Low</span>
                                    <svg class="w-3 h-3 ml-1 text-slate-500 cursor-help" fill="currentColor" viewBox="0 0 20 20"><path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg>
                                    <span class="tooltip-text" data-i18n="tip-low">Lowest price of the previous session.</span>
                                </label>
                                <input type="number" id="pLow" class="w-full p-2 rounded input-dark">
                            </div>
                            <div class="relative group">
                                <label class="text-xs text-slate-400 flex items-center mb-1">
                                    <span data-i18n="label-close">Close</span>
                                    <svg class="w-3 h-3 ml-1 text-slate-500 cursor-help" fill="currentColor" viewBox="0 0 20 20"><path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg>
                                    <span class="tooltip-text" data-i18n="tip-close">Closing price of the previous session.</span>
                                </label>
                                <input type="number" id="pClose" class="w-full p-2 rounded input-dark">
                            </div>
                        </div>
                        <button onclick="calculatePivots()" data-i18n="btn-calculate" class="w-full py-3 bg-sky-500 hover:bg-sky-600 rounded-lg font-bold shadow-lg">Generate Levels</button>
                    </div>
                    <div id="pivotDisplay" class="mt-4 space-y-1 hidden"></div>
                </div>

                <!-- Expected Move Calculator -->
                <div class="glass-card p-6 rounded-2xl shadow-xl flex flex-col">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="p-2 bg-purple-500/20 rounded-lg">
                                <svg class="w-6 h-6 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2z"></path></svg>
                            </div>
                            <h2 data-i18n="calc-move-title" class="text-xl font-bold">Expected Range (1 SD)</h2>
                        </div>
                        <button onclick="toggleInfo('move')" class="text-slate-500 hover:text-purple-400">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg>
                        </button>
                    </div>

                    <div id="info-move" class="hidden info-box p-5 mb-6 text-sm border-purple-500/50">
                        <h4 class="font-bold text-purple-400 mb-2" data-i18n="textbook-move-h">Textbook: Probability & Risk</h4>
                        <p class="text-slate-300 mb-4" data-i18n="textbook-move-p">Calculates a "1 Standard Deviation" move. Price stays inside this range 68% of the time.</p>
                        <div class="bg-slate-900 rounded-lg p-4 mb-4 overflow-x-auto space-y-4">
                            <div class="text-center">$$Move = Price \times IV \times \sqrt{\frac{T}{365}}$$</div>
                        </div>
                        <p class="text-xs text-slate-400" data-i18n="textbook-move-logic">Logic: Volatility scales with the square root of time. $IV$ is the annual fear index.</p>
                    </div>
                    
                    <div class="space-y-4 flex-grow">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="relative group">
                                <label class="text-xs text-slate-400 flex items-center mb-1">
                                    <span data-i18n="label-curr-price">Price</span>
                                    <svg class="w-3 h-3 ml-1 text-slate-500 cursor-help" fill="currentColor" viewBox="0 0 20 20"><path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg>
                                    <span class="tooltip-text" data-i18n="tip-price">Current market price of the asset.</span>
                                </label>
                                <input type="number" id="currPrice" class="w-full p-2 rounded input-dark">
                            </div>
                            <div class="relative group">
                                <label class="text-xs text-slate-400 flex items-center mb-1">
                                    <span data-i18n="label-iv">IV %</span>
                                    <svg class="w-3 h-3 ml-1 text-slate-500 cursor-help" fill="currentColor" viewBox="0 0 20 20"><path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg>
                                    <span class="tooltip-text" data-i18n="tip-iv">Implied Volatility (annual %).</span>
                                </label>
                                <input type="number" id="ivVal" class="w-full p-2 rounded input-dark">
                            </div>
                        </div>
                        <div class="relative group">
                            <label class="text-xs text-slate-400 flex items-center mb-1">
                                <span data-i18n="label-days">Days</span>
                                <svg class="w-3 h-3 ml-1 text-slate-500 cursor-help" fill="currentColor" viewBox="0 0 20 20"><path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg>
                                <span class="tooltip-text" data-i18n="tip-days">Number of days to forecast.</span>
                            </label>
                            <input type="number" id="daysVal" value="1" class="w-full p-2 rounded input-dark">
                        </div>
                        <button onclick="calculateExpectedMove()" data-i18n="btn-prob" class="w-full py-3 bg-purple-500 hover:bg-purple-600 rounded-lg font-bold shadow-lg">Generate Range</button>
                    </div>
                    <div id="moveDisplay" class="mt-4 space-y-1 hidden"></div>
                </div>

                <!-- Position Sizer -->
                <div class="glass-card p-6 rounded-2xl shadow-xl md:col-span-2">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="p-2 bg-emerald-500/20 rounded-lg">
                                <svg class="w-6 h-6 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2"></path></svg>
                            </div>
                            <h2 data-i18n="calc-risk-title" class="text-xl font-bold">Risk Management & Position Sizer</h2>
                        </div>
                        <button onclick="toggleInfo('risk')" class="text-slate-500 hover:text-emerald-400">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg>
                        </button>
                    </div>

                    <div id="info-risk" class="hidden info-box p-5 mb-6 text-sm border-emerald-500/50">
                        <h4 class="font-bold text-emerald-400 mb-2" data-i18n="textbook-risk-h">Textbook: Why Size Matters</h4>
                        <p class="text-slate-300 mb-4" data-i18n="textbook-risk-p">In a range, stop-losses are tight. Size ensures a "fakeout" doesn't destroy your capital.</p>
                        <div class="bg-slate-900 rounded-lg p-4 mb-2 overflow-x-auto text-center">
                            $$Units = \frac{Account \times Risk\%}{|Entry - Stop|}$$
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="relative group">
                            <label class="text-xs text-slate-400 flex items-center mb-1">
                                <span data-i18n="label-balance">Account ($)</span>
                                <svg class="w-3 h-3 ml-1 text-slate-500 cursor-help" fill="currentColor" viewBox="0 0 20 20"><path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg>
                                <span class="tooltip-text" data-i18n="tip-balance">Total account equity.</span>
                            </label>
                            <input type="number" id="balance" class="w-full p-2 rounded input-dark">
                        </div>
                        <div class="relative group">
                            <label class="text-xs text-slate-400 flex items-center mb-1">
                                <span data-i18n="label-risk-p">Risk %</span>
                                <svg class="w-3 h-3 ml-1 text-slate-500 cursor-help" fill="currentColor" viewBox="0 0 20 20"><path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg>
                                <span class="tooltip-text" data-i18n="tip-risk">Account % to lose if stop hit.</span>
                            </label>
                            <input type="number" id="riskPerc" value="1" class="w-full p-2 rounded input-dark">
                        </div>
                        <div class="relative group">
                            <label class="text-xs text-slate-400 flex items-center mb-1">
                                <span data-i18n="label-entry">Entry</span>
                                <svg class="w-3 h-3 ml-1 text-slate-500 cursor-help" fill="currentColor" viewBox="0 0 20 20"><path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg>
                                <span class="tooltip-text" data-i18n="tip-entry">Your target buy/sell price.</span>
                            </label>
                            <input type="number" id="entry" class="w-full p-2 rounded input-dark">
                        </div>
                        <div class="relative group">
                            <label class="text-xs text-slate-400 flex items-center mb-1">
                                <span data-i18n="label-stop">Stop</span>
                                <svg class="w-3 h-3 ml-1 text-slate-500 cursor-help" fill="currentColor" viewBox="0 0 20 20"><path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"></path></svg>
                                <span class="tooltip-text" data-i18n="tip-stop">Price where you admit wrong.</span>
                            </label>
                            <input type="number" id="stop" class="w-full p-2 rounded input-dark">
                        </div>
                    </div>
                    <button onclick="calculatePosition()" data-i18n="btn-units" class="w-full mt-4 py-3 bg-emerald-500 hover:bg-emerald-600 rounded-lg font-bold shadow-lg">Calculate Size</button>
                    <div id="positionResult" class="hidden mt-4 p-4 bg-emerald-500/10 border border-emerald-500/30 rounded-xl"></div>
                </div>

            </div>
        </section>

        <!-- KNOWLEDGE SECTION -->
        <section id="sect-knowledge" class="hidden animate-in fade-in duration-300">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Cards restored with full usage details -->
                <div class="glass-card p-6 rounded-2xl">
                    <h3 class="text-sky-400 font-bold text-lg mb-2">ADX</h3>
                    <p data-i18n="know-adx-desc" class="text-slate-400 text-sm mb-4">Ultimate trend filter. Values below 25 indicate a range.</p>
                </div>
                <div class="glass-card p-6 rounded-2xl">
                    <h3 class="text-emerald-400 font-bold text-lg mb-2">RSI</h3>
                    <p data-i18n="know-rsi-desc" class="text-slate-400 text-sm mb-4">Sell at > 70; Buy at < 30. Watch for divergence.</p>
                </div>
                <div class="glass-card p-6 rounded-2xl">
                    <h3 class="text-purple-400 font-bold text-lg mb-2">BB</h3>
                    <p data-i18n="know-bb-desc" class="text-slate-400 text-sm mb-4">Buy at lower band; Sell at upper band in horizontal markets.</p>
                </div>
                <div class="glass-card p-6 rounded-2xl">
                    <h3 class="text-amber-400 font-bold text-lg mb-2">CCI</h3>
                    <p data-i18n="know-cci-desc" class="text-slate-400 text-sm mb-4">Values above +100 signal ceiling; below -100 signal floor.</p>
                </div>
                <div class="glass-card p-6 rounded-2xl">
                    <h3 class="text-pink-400 font-bold text-lg mb-2">Stoch</h3>
                    <p data-i18n="know-stoch-desc" class="text-slate-400 text-sm mb-4">K crossing D below 20 confirms entry timing.</p>
                </div>
                <div class="glass-card p-6 rounded-2xl">
                    <h3 class="text-orange-400 font-bold text-lg mb-2">ATR</h3>
                    <p data-i18n="know-atr-desc" class="text-slate-400 text-sm mb-4">Set stops at 2x ATR outside range boundaries.</p>
                </div>
            </div>
        </section>

        <!-- STRATEGIES SECTION -->
        <section id="sect-strategies" class="hidden">
            <div class="glass-card rounded-2xl p-8">
                <h2 data-i18n="strat-matrix-title" class="text-2xl font-bold mb-6 text-sky-400 border-b border-slate-700 pb-2">The Confluence Matrix</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="p-4 bg-emerald-500/5 rounded-xl border border-emerald-500/20">
                        <h3 data-i18n="strat-buy-setup" class="text-emerald-400 font-bold mb-3">üü¢ Buy Setup (Range Floor)</h3>
                        <ul class="space-y-3 text-sm text-slate-300">
                            <li><strong>1. Level:</strong> Price touches Support or S2 Pivot.</li>
                            <li><strong>2. Trend:</strong> ADX is < 25.</li>
                            <li><strong>3. Exhaustion:</strong> RSI is < 30.</li>
                            <li><strong>4. Timing:</strong> Stochastic cross up.</li>
                        </ul>
                    </div>
                    <div class="p-4 bg-red-500/5 rounded-xl border border-red-500/20">
                        <h3 data-i18n="strat-sell-setup" class="text-red-400 font-bold mb-3">üî¥ Sell Setup (Range Ceiling)</h3>
                        <ul class="space-y-3 text-sm text-slate-300">
                            <li><strong>1. Level:</strong> Price touches Resistance or R2 Pivot.</li>
                            <li><strong>2. Trend:</strong> ADX is < 25.</li>
                            <li><strong>3. Exhaustion:</strong> RSI is > 70.</li>
                            <li><strong>4. Timing:</strong> Stochastic cross down.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script>
        const translations = {
            en: {
                "header-title": "Range Trading Hub",
                "header-subtitle": "Professional Computational Textbook",
                "tab-calc": "Calculators", "tab-know": "Knowledge", "tab-strat": "Strategies",
                "calc-pivot-title": "Pivot Points (Floor)", "calc-move-title": "Expected Range (1 SD)", "calc-risk-title": "Risk & Position",
                "label-high": "High", "label-low": "Low", "label-close": "Close",
                "label-curr-price": "Price", "label-iv": "IV %", "label-days": "Days",
                "label-balance": "Account", "label-risk-p": "Risk %", "label-entry": "Entry", "label-stop": "Stop",
                "btn-calculate": "Generate Levels", "btn-prob": "Generate Range", "btn-units": "Calculate Position",
                "textbook-pivot-h": "Textbook: What are Pivot Points?",
                "textbook-pivot-p": "Pivots are mathematical 'gravity centers' based on the previous session's range.",
                "textbook-pivot-logic": "Logic: $PP$ is fair value. $R1/S1$ are boundaries, $R2/S2$ are extreme deviation points.",
                "textbook-move-h": "Textbook: Probability & Risk",
                "textbook-move-p": "Calculates a '1 SD' move. Price stays inside 68% of the time.",
                "textbook-move-logic": "Logic: Volatility scales with $\\sqrt{T}$. $IV$ is the annual fear index.",
                "textbook-risk-h": "Textbook: Risk Management",
                "textbook-risk-p": "Size strictly ensures a 'fakeout' doesn't destroy your capital.",
                "tip-high": "The highest price traded last session.",
                "tip-low": "The lowest price traded last session.",
                "tip-close": "The price at market close last session.",
                "tip-price": "The current market price.",
                "tip-iv": "Implied Volatility (Annual % expectation).",
                "tip-days": "Number of days for forecast.",
                "tip-balance": "Your total trading capital.",
                "tip-risk": "Account % to lose if stop hit.",
                "tip-entry": "Your target entry price.",
                "tip-stop": "Exit price if wrong.",
                "know-adx-desc": "Filter trend. Below 25 = Sideways.",
                "know-rsi-desc": "Overbought/Oversold momentum index.",
                "know-bb-desc": "Buy low/Sell high in horizontal channels.",
                "know-cci-desc": "Cyclical turns for range extremes.",
                "know-stoch-desc": "Best for entry timing via crosses.",
                "know-atr-desc": "Use 2x ATR for noise-free stops.",
                "res-units": "Units", "res-risk": "Risk Amount", "res-upper": "Upper Band", "res-lower": "Lower Band",
                "strat-matrix-title": "Confluence Checklist", "strat-buy-setup": "Buy Setup (Floor)", "strat-sell-setup": "Sell Setup (Ceiling)"
            },
            zh: {
                "header-title": "ÂçÄÈñì‰∫§Êòì‰∏≠ÂøÉ",
                "header-subtitle": "Â∞àÊ•≠Á¥öË®àÁÆóÊïôÁßëÊõ∏",
                "tab-calc": "Ë®àÁÆóÊ©ü", "tab-know": "Áü•Ë≠òÂ∫´", "tab-strat": "‰∫§ÊòìÁ≠ñÁï•",
                "calc-pivot-title": "Ê®ûËª∏Èªû (Floor)", "calc-move-title": "È†êÊúüÊ≥¢Âãï (1 SD)", "calc-risk-title": "È¢®Èö™ËàáÂÄâ‰Ωç",
                "label-high": "ÊúÄÈ´òÂÉπ", "label-low": "ÊúÄ‰ΩéÂÉπ", "label-close": "Êî∂Â∏ÇÂÉπ",
                "label-curr-price": "ÁèæÂÉπ", "label-iv": "Èö±Âê´Ê≥¢ÂãïÁéá %", "label-days": "Â§©Êï∏",
                "label-balance": "Ë≥¨Êà∂È§òÈ°ç", "label-risk-p": "È¢®Èö™ %", "label-entry": "ÂÖ•Â†¥", "label-stop": "Ê≠¢Êêç",
                "btn-calculate": "ÁîüÊàêÊ∞¥Âπ≥", "btn-prob": "ÁîüÊàêÂçÄÈñì", "btn-units": "Ë®àÁÆóÂÄâ‰Ωç",
                "textbook-pivot-h": "ÊïôÁßëÊõ∏Ôºö‰ªÄÈ∫ºÊòØÊ®ûËª∏ÈªûÔºü",
                "textbook-pivot-p": "Ê®ûËª∏ÈªûÊòØÂü∫ÊñºÂâç‰∏Ä‰∫§ÊòìÊó•ÂÉπÊ†ºÁØÑÂúçÁöÑÊï∏Â≠∏„ÄåÈáçÂäõ‰∏≠ÂøÉ„Äç„ÄÇ",
                "textbook-pivot-logic": "ÈÇèËºØÔºö$PP$ ÁÇ∫ÂÖ¨ÂÖÅÂÉπÂÄº„ÄÇ$R1/S1$ Ë≠òÂà•Âç≥ÊôÇÈÇäÁïåÔºå$R2/S2$ ÁÇ∫Ê•µÁ´ØÂÅèÈõ¢Èªû„ÄÇ",
                "textbook-move-h": "ÊïôÁßëÊõ∏ÔºöÊ¶ÇÁéáËàáÈ¢®Èö™",
                "textbook-move-p": "Ë®àÁÆó„Äå1 ÂÄãÊ®ôÊ∫ñÂ∑Æ„ÄçÁöÑÁßªÂãï„ÄÇÁµ±Ë®à‰∏äÔºåÂÉπÊ†ºÊúâ 68% ÁöÑÊôÇÈñìÊúÉÁïôÂú®Ë©≤ÁØÑÂúçÂÖß„ÄÇ",
                "textbook-move-logic": "ÈÇèËºØÔºöÊ≥¢ÂãïÁéáÈö® $\\sqrt{T}$ Á∏ÆÊîæ„ÄÇ$IV$ ÊòØÂ∏ÇÂ†¥Âπ¥Â∫¶ÊÅêÊÖåÊåáÊï∏„ÄÇ",
                "textbook-risk-h": "ÊïôÁßëÊõ∏ÔºöÈ¢®Èö™ÁÆ°ÁêÜ",
                "textbook-risk-p": "Âö¥Ê†ºÊéßÂà∂ÂÄâ‰ΩçÔºåÁ¢∫‰øùÂÅáÁ™ÅÁ†¥‰∏çÊúÉÊØÄÊéâ‰Ω†ÁöÑË≥áÊú¨„ÄÇ",
                "tip-high": "‰∏ä‰∏Ä‰∫§ÊòìÊó•ÁöÑÊúÄÈ´òÂÉπÊ†º„ÄÇ",
                "tip-low": "‰∏ä‰∏Ä‰∫§ÊòìÊó•ÁöÑÊúÄ‰ΩéÂÉπÊ†º„ÄÇ",
                "tip-close": "‰∏ä‰∏Ä‰∫§ÊòìÊó•ÁöÑÊî∂Áõ§ÂÉπÊ†º„ÄÇ",
                "tip-price": "Áï∂ÂâçÂ∏ÇÂ†¥ÂÉπÊ†º„ÄÇ",
                "tip-iv": "Èö±Âê´Ê≥¢ÂãïÁéá (Âπ¥Â∫¶Ê≥¢ÂãïÈ†êÊúü %)„ÄÇ",
                "tip-days": "È†êÊ∏¨Êú™‰æÜÁöÑÂ§©Êï∏„ÄÇ",
                "tip-balance": "‰Ω†ÁöÑÁ∏Ω‰∫§ÊòìË≥¨Êà∂Ë≥áÈáë„ÄÇ",
                "tip-risk": "Ëß∏ÂèäÊ≠¢ÊêçÊôÇÔºå‰Ω†Ê∫ñÂÇôÊêçÂ§±Á∏ΩË≥áÁî¢ÁöÑÁôæÂàÜÊØî„ÄÇ",
                "tip-entry": "‰Ω†ÁöÑÈ†êÂÆöË≤∑ÂÖ•ÊàñË≥£Âá∫ÂÉπÊ†º„ÄÇ",
                "tip-stop": "Â¶ÇÊûúË°åÊÉÖÂà§Êñ∑ÈåØË™§ÔºåÂøÖÈ†àÂπ≥ÂÄâÁöÑÂÉπÊ†º„ÄÇ",
                "know-adx-desc": "ÈÅéÊøæË∂®Âã¢„ÄÇ‰ΩéÊñº 25 = Ê©´Áõ§„ÄÇ",
                "know-rsi-desc": "Ë°°ÈáèË∂ÖË≤∑/Ë∂ÖË≥£ÁöÑÂãïËÉΩÊåáÊ®ô„ÄÇ",
                "know-bb-desc": "Âú®Ê∞¥Âπ≥ÈÄöÈÅì‰∏≠‰ΩéË≤∑È´òË≥£„ÄÇ",
                "know-cci-desc": "Ë≠òÂà•ÂçÄÈñìÊ•µÁ´ØÁöÑÈÄ±ÊúüÊÄßËΩâÂêë„ÄÇ",
                "know-stoch-desc": "ÊúÄÈÅ©ÂêàÈÄèÈÅé‰∫§ÂèâÂà§Êñ∑ÂÖ•Â†¥ÊôÇÊ©ü„ÄÇ",
                "know-atr-desc": "‰ΩøÁî® 2x ATR Ë®≠ÁΩÆÁÑ°Âô™ËÅ≤Ê≠¢Êêç„ÄÇ",
                "res-units": "Êàê‰∫§ÂñÆ‰ΩçÊï∏Èáè", "res-risk": "È¢®Èö™ÈáëÈ°ç", "res-upper": "‰∏äÈôêÂÄº", "res-lower": "‰∏ãÈôêÂÄº",
                "strat-matrix-title": "Â§öÈáçÂåØËÅöÊ∏ÖÂñÆ", "strat-buy-setup": "Ë≤∑ÂÖ•Ë®≠ÁΩÆ (Âú∞Êùø)", "strat-sell-setup": "Ë≥£Âá∫Ë®≠ÁΩÆ (Â§©Ëä±Êùø)"
            }
        };

        let currentLang = 'en';

        function setLanguage(lang) {
            currentLang = lang;
            document.getElementById('btn-en').className = lang === 'en' ? 'px-3 py-1 text-xs font-bold rounded transition-all bg-sky-500 text-white' : 'px-3 py-1 text-xs font-bold rounded transition-all text-slate-400 hover:text-white';
            document.getElementById('btn-zh').className = lang === 'zh' ? 'px-3 py-1 text-xs font-bold rounded transition-all bg-sky-500 text-white' : 'px-3 py-1 text-xs font-bold rounded transition-all text-slate-400 hover:text-white';
            
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang][key]) el.innerText = translations[lang][key];
            });
            try { renderMathInElement(document.body); } catch(e) {}
        }

        function switchTab(tabId) {
            const tabs = ['calculators', 'knowledge', 'strategies'];
            tabs.forEach(t => {
                const tabEl = document.getElementById('tab-' + t);
                const sectEl = document.getElementById('sect-' + t);
                tabEl.classList.remove('tab-active');
                tabEl.classList.add('text-slate-500');
                sectEl.classList.add('hidden');
            });
            document.getElementById('tab-' + tabId).classList.add('tab-active');
            document.getElementById('tab-' + tabId).classList.remove('text-slate-500');
            document.getElementById('sect-' + tabId).classList.remove('hidden');
        }

        function toggleInfo(id) {
            const el = document.getElementById('info-' + id);
            el.classList.toggle('hidden');
            try { renderMathInElement(el); } catch(e) {}
        }

        function calculatePivots() {
            const h = parseFloat(document.getElementById('pHigh').value);
            const l = parseFloat(document.getElementById('pLow').value);
            const c = parseFloat(document.getElementById('pClose').value);
            if (isNaN(h)) return;
            const pp = (h + l + c) / 3;
            const r1 = (2 * pp) - l;
            const s1 = (2 * pp) - h;
            const r2 = pp + (h - l);
            const s2 = pp - (h - l);
            const display = document.getElementById('pivotDisplay');
            display.classList.remove('hidden');
            display.innerHTML = `
                <div class="flex justify-between p-2 text-red-400 border-b border-slate-700"><span>R2</span><strong>${r2.toFixed(2)}</strong></div>
                <div class="flex justify-between p-2 text-red-300 border-b border-slate-700"><span>R1</span><strong>${r1.toFixed(2)}</strong></div>
                <div class="flex justify-between p-2 text-sky-400 font-bold bg-sky-500/10 rounded"><span>PP</span><strong>${pp.toFixed(2)}</strong></div>
                <div class="flex justify-between p-2 text-emerald-300 border-b border-slate-700"><span>S1</span><strong>${s1.toFixed(2)}</strong></div>
                <div class="flex justify-between p-2 text-emerald-400"><span>S2</span><strong>${s2.toFixed(2)}</strong></div>
            `;
        }

        function calculateExpectedMove() {
            const cp = parseFloat(document.getElementById('currPrice').value);
            const iv = parseFloat(document.getElementById('ivVal').value) / 100;
            const days = parseFloat(document.getElementById('daysVal').value);
            if (isNaN(cp)) return;
            const move = cp * iv * Math.sqrt(days / 365);
            const upper = cp + move;
            const lower = cp - move;
            const display = document.getElementById('moveDisplay');
            display.classList.remove('hidden');
            display.innerHTML = `
                <div class="flex justify-between p-2 text-slate-400 border-b border-slate-700"><span>Move ¬±</span><strong>${move.toFixed(2)}</strong></div>
                <div class="flex justify-between p-2 text-red-400 font-bold"><span>${translations[currentLang]['res-upper']}</span><strong>${upper.toFixed(2)}</strong></div>
                <div class="flex justify-between p-2 text-emerald-400 font-bold"><span>${translations[currentLang]['res-lower']}</span><strong>${lower.toFixed(2)}</strong></div>
            `;
        }

        function calculatePosition() {
            const bal = parseFloat(document.getElementById('balance').value);
            const rP = parseFloat(document.getElementById('riskPerc').value) / 100;
            const ent = parseFloat(document.getElementById('entry').value);
            const stp = parseFloat(document.getElementById('stop').value);
            if (isNaN(bal) || isNaN(ent) || isNaN(stp)) return;
            const riskAmt = bal * rP;
            const dist = Math.abs(ent - stp);
            const units = dist === 0 ? 0 : riskAmt / dist;
            const res = document.getElementById('positionResult');
            res.classList.remove('hidden');
            res.innerHTML = `
                <div class="text-slate-400 text-xs mb-1">${translations[currentLang]['res-risk']}: $${riskAmt.toFixed(2)}</div>
                <div class="text-2xl font-bold text-emerald-400">${units.toFixed(2)} ${translations[currentLang]['res-units']}</div>
            `;
        }
    </script>
</body>
</html>
